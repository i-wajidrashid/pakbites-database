select o.order_id, concat(c.first_name, ' ', c.last_name) as customer_name, r.name as restaurant_name, concat(dr.first_name, ' ', dr.last_name) as rider_name 
from orders o 
inner join customers c on o.customer_id = c.customer_id 
inner join restaurants r on o.restaurant_id = r.restaurant_id 
inner join deliveryriders dr on o.rider_id = dr.rider_id;

select r.name, count(m.item_id) as menu_item_count 
from restaurants r 
left join menuitems m on r.restaurant_id = m.restaurant_id 
group by r.restaurant_id, r.name;

select concat(c.first_name, ' ', c.last_name) as customer_name, count(o.order_id) as order_count 
from customers c 
left join orders o on c.customer_id = o.customer_id 
group by c.customer_id, c.first_name, c.last_name;

select o.order_id, concat(c.first_name, ' ', c.last_name) as customer_name, r.name as restaurant_name, concat(dr.first_name, ' ', dr.last_name) as rider_name, o.total_amount, count(oi.order_item_id) as item_count 
from orders o 
join customers c on o.customer_id = c.customer_id 
join restaurants r on o.restaurant_id = r.restaurant_id 
left join deliveryriders dr on o.rider_id = dr.rider_id 
join orderitems oi on o.order_id = oi.order_id 
group by o.order_id, c.first_name, c.last_name, r.name, dr.first_name, dr.last_name, o.total_amount;

select mi.item_name, oi.quantity, oi.line_total, o.order_status 
from orderitems oi 
inner join menuitems mi on oi.item_id = mi.item_id 
inner join orders o on oi.order_id = o.order_id;

select concat(dr.first_name, ' ', dr.last_name) as rider_name, count(o.order_id) as delivered_orders 
from deliveryriders dr 
left join orders o on dr.rider_id = o.rider_id and o.order_status = 'delivered' 
group by dr.rider_id, dr.first_name, dr.last_name;

select r1.name as restaurant_a, r2.name as restaurant_b, r1.city_id 
from restaurants r1 
inner join restaurants r2 on r1.city_id = r2.city_id and r1.restaurant_id < r2.restaurant_id;

select order_id, old_status, new_status, changed_at 
from orderstatushistory 
where order_id = 1 
order by changed_at asc;